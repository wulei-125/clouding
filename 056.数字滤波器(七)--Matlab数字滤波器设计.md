数字滤波器(七)--Matlab数字滤波器设计

[TOC]
## IIR滤波器设计
### 巴特沃夫滤波器设计
巴特沃斯滤波器（Butterworth filter）称作最大平坦滤波器。巴特沃斯滤波器的特点是通频带内的频率响应曲线最大限度平坦，没有纹波，而在阻频带则逐渐下降为零。

巴特沃斯滤波器的特点是通频带内的频率响应曲线最大限度平坦，没有起伏，而在阻频带则逐渐下降为零。 在振幅的对数对角频率的波特图上，从某一边界角频率开始，振幅随着角频率的增加而逐步减少,趋向负无穷大。

- 巴特沃斯滤波器优点:

巴特沃斯滤波器的特点是通频带内的频率响应曲线最大限度平坦，没有起伏，而在阻频带则逐渐下降为零。在振幅的对数对角频率的波得图上，从某一边界角频率开始，振幅随着角频率的增加而逐渐减少，趋向负无穷大。

一阶巴特沃斯滤波器的衰减率为每倍频6分贝，每十倍频20分贝。二阶巴特沃斯滤波器的衰减率为每倍频12分贝，三阶巴特沃斯滤波器的衰减率为每倍频18分贝，如此类推。巴特沃斯滤波器的振幅对角频率单调下降，并且也是唯一的无论阶数、振幅对角频率曲线都保持同样的形状的滤波器。只不过滤波器阶数越高，在阻频带振幅衰减速度越快。其他滤波器高阶的振幅对角频率图和低级数的振幅对角频率有不同的形状。

- 巴特沃斯滤波器缺点:

巴特沃斯滤波器是滤波器的一种设计分类，类同于切比雪夫滤波器，它有高通，低通，带通，高通，带阻等多种滤波器。它在通频带内外都有平稳的幅频特性，但有较长的过渡带，在过渡带上很容易造成失真，在调用MATLAB里的巴特沃斯滤波器做仿真时，信号总会在第一个周期略微有些失真。但往后的幅频特性就非常的好。

- 与其它滤波器比较

下图是巴特沃斯滤波器（左上）和同阶第一类切比雪夫滤波器（右上）、第二类切比雪夫滤波器（左下）、椭圆函数滤波器（右下）的频率响应图。

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-rqwzonNZ-1573573081125)(G:\研究生\项目小组任务\笔记\第四周笔记\vfbht.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191112233839303.jpg)

**原始信号设定**
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  ButterWorthFilter.m
%  巴特沃夫滤波器的设计
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
clear;
close all;
clc;
 
fs = 1000; %Hz 采样频率
Ts = 1/fs;
N  = 1000; %序列长度
t = (0:N-1)*Ts;
delta_f = 1*fs/N;
f1 = 50;
f2 = 100;
f3 = 200;
f4 = 400;
x1 = 2*0.5*sin(2*pi*f1*t);
x2 = 2*0.2*sin(2*pi*f2*t);
x3 = 2*0.3*sin(2*pi*f3*t);
x4 = 2*0.6*sin(2*pi*f4*t);
x = x1 + x2 + x3 + x4; %待处理信号由四个分量组成
 
X = fftshift(abs(fft(x)))/N;
X_angle = fftshift(angle(fft(x)));
f = (-N/2:N/2-1)*delta_f;
 
figure(1);
subplot(3,1,1);
plot(t,x);
title('原信号');
subplot(3,1,2);
plot(f,X);
grid on;
title('原信号频谱幅度特性');
subplot(3,1,3);
plot(f,X_angle);
title('原信号频谱相位特性');
grid on;
```
![img](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191112233918417.jpg)
#### 低通滤波器
```matlab
%设计一个巴特沃夫低通滤波器,要求把50Hz的频率分量保留,其他分量滤掉
wp = 65/(fs/2);  %通带截止频率,取50~100中间的值,并对其归一化
ws = 85/(fs/2);  %阻带截止频率,取50~100中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N1 wc1 ] = buttord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = butter(N1,wc1,'low');
%滤波
filter_lp_s = filter(b,a,x);
X_lp_s = fftshift(abs(fft(filter_lp_s)))/N;
X_lp_s_angle = fftshift(angle(fft(filter_lp_s)));
figure(2);
freqz(b,a); %滤波器频谱特性
figure(3);
subplot(3,1,1);
plot(t,filter_lp_s);
grid on;
title('低通滤波后时域图形');
subplot(3,1,2);
plot(f,X_lp_s);
title('低通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_lp_s_angle);
title('低通滤波后频域相位特性');

```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-H50wW5yZ-1573573081136)(G:\研究生\项目小组任务\笔记\第四周笔记\lowp2.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191112233949981.jpg)
#### 高通滤波器
```matlab
%设计一个高通滤波器,要求把400Hz的频率分量保留,其他分量滤掉
wp = 350/(fs/2);  %通带截止频率,取200~400中间的值,并对其归一化
ws = 380/(fs/2);  %阻带截止频率,取200~400中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N2 wc2 ] = buttord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = butter(N2,wc2,'high');
%滤波
filter_hp_s = filter(b,a,x);
X_hp_s = fftshift(abs(fft(filter_hp_s)))/N;
X_hp_s_angle = fftshift(angle(fft(filter_hp_s)));
figure(4);
freqz(b,a); %滤波器频谱特性
figure(5);
subplot(3,1,1);
plot(t,filter_hp_s);
grid on;
title('高通滤波后时域图形');
subplot(3,1,2);
plot(f,X_hp_s);
title('高通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_hp_s_angle);
title('高通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-BpgsxyoK-1573573081139)(G:\研究生\项目小组任务\笔记\第四周笔记\hightp2.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191112234020106.jpg)
#### 带通滤波器

```matlab
%设计一个带通滤波器,要求把50Hz和400Hz的频率分量滤掉,其他分量保留
wp = [65 385 ] / (fs/2);  %通带截止频率,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N3 wn ] = buttord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = butter(N3,wn,'bandpass');
%滤波
filter_bp_s = filter(b,a,x);
X_bp_s = fftshift(abs(fft(filter_bp_s)))/N;
X_bp_s_angle = fftshift(angle(fft(filter_bp_s)));
figure(6);
freqz(b,a); %滤波器频谱特性
figure(7);
subplot(3,1,1);
plot(t,filter_bp_s);
grid on;
title('带通滤波后时域图形');
subplot(3,1,2);
plot(f,X_bp_s);
title('带通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bp_s_angle);
title('带通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-gOZIJ7Kq-1573573081144)(G:\研究生\项目小组任务\笔记\第四周笔记\bandp2.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191112234054768.jpg)
#### 带阻滤波器
```matlab
%设计一个带阻滤波器,要求把50Hz和400Hz的频率分量保留,其他分量滤掉
wp = [65 385 ] / (fs/2);  %通带截止频率?,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率?,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N4 wn ] = buttord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = butter(N4,wn,'stop');
%滤波
filter_bs_s = filter(b,a,x);
X_bs_s = fftshift(abs(fft(filter_bs_s)))/N;
X_bs_s_angle = fftshift(angle(fft(filter_bs_s)));
figure(8);
freqz(b,a); %滤波器频谱特性
figure(9);
subplot(3,1,1);
plot(t,filter_bs_s);
grid on;
title('带阻滤波后时域图形');
subplot(3,1,2);
plot(f,X_bs_s);
title('带阻滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bs_s_angle);
title('带阻滤波后频域相位特性');
```
![img](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191112234122358.jpg)
### 切比雪夫I型滤波器设计
切比雪夫滤波器，又名“车比雪夫滤波器”，是在通带或阻带上频率响应幅度等波纹波动的滤波器。切比雪夫滤波器来自切比雪夫分布，以“切比雪夫”命名，是用以纪念俄罗斯数学家巴夫尼提·列波维其·切比雪夫。

切比雪夫Ⅰ型滤波器特点：

切比雪夫滤波器在过渡带比巴特沃斯滤波器的衰减快，但频率响应的幅频特性不如后者平坦。切比雪夫滤波器和理想滤波器的频率响应曲线之间的误差最小，但是在通频带内存在幅度波动。

- 1、幅度特性是在一个频带内（通带或阻带）范围内具有等波纹特性；
- 2、Ⅰ型在通带范围内是等波纹的，在阻带范围内是单调的。

根据频率响应曲线波动位置的不同，切比雪夫滤波器可以分为以下两种：

**I型切比雪夫滤波器**

在通带（或称“通频带”）上频率响应幅度等波纹波动的滤波器称为“I型切比雪夫滤波器”；

**原始信号设定**
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Cheby1Filter.m
%  切比雪夫Ⅰ型滤波器的设计
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear;
close all;
clc;

fs = 1000; %Hz 采样频率
Ts = 1/fs;
N  = 1000; %序列长度
t = (0:N-1)*Ts;
delta_f = 1*fs/N;
f1 = 50;
f2 = 100;
f3 = 200;
f4 = 400;
x1 = 2*0.5*sin(2*pi*f1*t);
x2 = 2*0.5*sin(2*pi*f2*t);
x3 = 2*0.5*sin(2*pi*f3*t);
x4 = 2*0.5*sin(2*pi*f4*t);
x = x1 + x2 + x3 + x4; %待处理信号由四个分量组成
 
X = fftshift(abs(fft(x)))/N;
X_angle = fftshift(angle(fft(x)));
f = (-N/2:N/2-1)*delta_f;
 
figure(1);
subplot(3,1,1);
plot(t,x);
title('原信号');
subplot(3,1,2);
plot(f,X);
grid on;
title('原信号频谱幅度特性');
subplot(3,1,3);
plot(f,X_angle);
title('原信号频谱相位特性');
grid on;
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ZDDVsYax-1573631016234)(G:\研究生\项目小组任务\笔记\第四周笔记\qubify.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113154738715.jpg)
#### 低通滤波器

```matlab
%设计一个切比雪夫低通滤波器,要求把50Hz的频率分量保留,其他分量滤掉
wp = 55/(fs/2);  %通带截止频率,取50~100中间的值,并对其归一化
ws = 90/(fs/2);  %阻带截止频率,取50~100中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为 db
alpha_s = 40;%阻带允许最小衰减为 db
%获取阶数和截止频率
[ N1 wc1 ] = cheb1ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby1(N1,alpha_p,wc1,'low');
%滤波
filter_lp_s = filter(b,a,x);
X_lp_s = fftshift(abs(fft(filter_lp_s)))/N;
X_lp_s_angle = fftshift(angle(fft(filter_lp_s)));
figure(2);
freqz(b,a); %滤波器频谱特性
figure(3);
subplot(3,1,1);
plot(t,filter_lp_s);
grid on;
title('低通滤波后时域图形');
subplot(3,1,2);
plot(f,X_lp_s);
title('低通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_lp_s_angle);
title('低通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-a6R66EbD-1573631016238)(G:\研究生\项目小组任务\笔记\第四周笔记\lowp.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113154843642.jpg)

##### **双线性变换法IIR切比雪夫滤波器**
```matlab
wp=0.2*pi;ws=0.6*pi;rp=3;rs=40;      %数字滤波器指标
Omgp=tan(wp/2)
Omgs=tan(ws/2)        %转化为模拟滤波器指标（K=1）
Fs=0.5;
%模拟原型滤波器计算
[N,wo]=cheb1ord(Omgp,Omgs,rp,rs,'s')%计算阶数N和截止频率wo
[b,a]=cheby1(N,rp,wo,'s')         %求原型滤波器系数b，a
[Ha,Omg]=freqs(b,a);              %求模拟系统频率特性
dbHa=20*log((abs(Ha)+eps)/max(abs(Ha)));%求分贝值，加eps以避开0点
%计算数字滤波器
[bd,ad]=bilinear(b,a,0.5);        %用双线性变换法求数字滤波器系数bd,ad
[H,w]=freqz(bd,ad);                %求数字系统频率特性
dbH=20*log10(abs(H)/max(abs(H)));  %化为分贝值
%画图
subplot(3,2,1),plot(Omg*Omgp/2/pi,dbHa),grid
title('a 模拟幅度响应（dB)');ylabel('幅度/dB');xlabel('f/Hz');
subplot(3,2,2),plot(w/pi,abs(H))
title('b 幅度响应');axis([0,1,0,1]);
subplot(3,2,3),plot(w/pi,dbH),grid
title('c 幅度响应(dB）');axis([0,1,-300,100]);
subplot(3,2,4),plot(w/pi,dbH),grid
title('d 幅度响应(dB）');axis([0,0.7,-60,5]);
subplot(3,2,5),plot(w/pi,angle(H)/pi)
title('e 相位响应');axis([0,1,-1,1]);
subplot(3,2,6),zplane(bd,ad)
title('f 零极图');axis([-1.1,1.1,-1.1,1.1]);
```
```matlab
Omgp =
    0.3249
Omgs =
    1.3764
N =
     3
wo =
    0.3249
b =
         0         0         0    0.0086
a =
 
    1.0000    0.1941    0.0980    0.0086
```
![image-20201228141826130](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/image-20201228141826130.jpg)

#### 高通滤波器

```matlab
%设计一个高通滤波器,要求把400Hz的频率分量保留,其他分量滤掉
wp = 350/(fs/2);  %通带截止频率,取200~400中间的值,并对其归一化
ws = 380/(fs/2);  %阻带截止频率,取200~400中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N2 wc2 ] = cheb1ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby1(N2,alpha_p,wc2,'high');
%滤波
filter_hp_s = filter(b,a,x);
X_hp_s = fftshift(abs(fft(filter_hp_s)))/N;
X_hp_s_angle = fftshift(angle(fft(filter_hp_s)));
figure(4);
freqz(b,a); %滤波器频谱特性
figure(5);
subplot(3,1,1);
plot(t,filter_hp_s);
grid on;
title('高通滤波后时域图形');
subplot(3,1,2);
plot(f,X_hp_s);
title('高通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_hp_s_angle);
title('高通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-LPt70b8v-1573631016257)(G:\研究生\项目小组任务\笔记\第四周笔记\hightp.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113154936419.jpg)
#### 带通滤波器
```matlab
%设计一个带通滤波器,要求把50Hz和400Hz的频率分量滤掉,其他分量保留
wp = [65 385 ] / (fs/2);  %通带截止频率,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N3 wn ] = cheb1ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby1(N3,alpha_p,wn,'bandpass');
%滤波
filter_bp_s = filter(b,a,x);
X_bp_s = fftshift(abs(fft(filter_bp_s)))/N;
X_bp_s_angle = fftshift(angle(fft(filter_bp_s)));
figure(6);
freqz(b,a); %滤波器频谱特性
figure(7);
subplot(3,1,1);
plot(t,filter_bp_s);
grid on;
title('带通滤波后时域图形');
subplot(3,1,2);
plot(f,X_bp_s);
title('带通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bp_s_angle);
title('带通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-3XBKXRhq-1573631016258)(G:\研究生\项目小组任务\笔记\第四周笔记\bandp.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113155018911.jpg)
#### 带阻滤波器
```matlab
%设计一个带阻滤波器,要求把50Hz和400Hz的频率分量保留,其他分量滤掉
wp = [65 385 ] / (fs/2);  %通带截止频率?,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率?,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 20;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N4 wn ] = cheb1ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby1(N4,alpha_p,wn,'stop');
%滤波
filter_bs_s = filter(b,a,x);
X_bs_s = fftshift(abs(fft(filter_bs_s)))/N;
X_bs_s_angle = fftshift(angle(fft(filter_bs_s)));
figure(8);
freqz(b,a); %滤波器频谱特性
figure(9);
subplot(3,1,1);
plot(t,filter_bs_s);
grid on;
title('带阻滤波后时域图形');
subplot(3,1,2);
plot(f,X_bs_s);
title('带阻滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bs_s_angle);
title('带阻滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ccbiuMxk-1573631016258)(G:\研究生\项目小组任务\笔记\第四周笔记\bands.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113155108428.jpg)
### 切比雪夫II型滤波器设计
**II型切比雪夫滤波器**

在阻带（或称“阻频带”）上频率响应幅度等波纹波动的滤波器称为“II型切比雪夫滤波器”。

也称倒数切比雪夫滤波器，较不常用，因为频率截止速度不如I型快，也需要用更多的电子元件。II型切比雪夫滤波器在通频带内没有幅度波动，只在阻频带内有幅度波动。

切比雪夫Ⅱ型滤波器特点：

- 1、幅度特性是在一个频带内（通带或阻带）范围内具有等波纹特性；

- 2、Ⅱ型在通带范围内是单调的，在阻带范围内是等波纹的。

**原始信号设定**
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Cheby2Filter.m
%  切比雪夫Ⅱ型滤波器的设计
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
clear;
close all;
clc;
 
fs = 1000; %Hz 采样频率
Ts = 1/fs;
N  = 1000; %序列长度
t = (0:N-1)*Ts;
delta_f = 1*fs/N;
f1 = 50;
f2 = 100;
f3 = 200;
f4 = 400;
x1 = 2*0.5*sin(2*pi*f1*t);
x2 = 2*0.5*sin(2*pi*f2*t);
x3 = 2*0.5*sin(2*pi*f3*t);
x4 = 2*0.5*sin(2*pi*f4*t);
x = x1 + x2 + x3 + x4; %待处理信号由四个分量组成
 
X = fftshift(abs(fft(x)))/N;
X_angle = fftshift(angle(fft(x)));
f = (-N/2:N/2-1)*delta_f;
 
figure(1);
subplot(3,1,1);
plot(t,x);
title('原信号');
subplot(3,1,2);
plot(f,X);
grid on;
title('原信号频谱幅度特性');
subplot(3,1,3);
plot(f,X_angle);
title('原信号频谱相位特性');
grid on;
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-lwY7FDzh-1573631797431)(G:\研究生\项目小组任务\笔记\第四周笔记\qubify1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113155716759.jpg)
#### 低通滤波器
```matlab
%设计一个切比雪夫低通滤波器,要求把50Hz的频率分量保留,其他分量滤掉
wp = 55/(fs/2);  %通带截止频率,取50~100中间的值,并对其归一化
ws = 60/(fs/2);  %阻带截止频率,取50~100中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为 db
alpha_s = 40;%阻带允许最小衰减为 db
%获取阶数和截止频率
[ N1 wc1 ] = cheb2ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby2(N1,alpha_s,wc1,'low');
%滤波
filter_lp_s = filter(b,a,x);
X_lp_s = fftshift(abs(fft(filter_lp_s)))/N;
X_lp_s_angle = fftshift(angle(fft(filter_lp_s)));
figure(2);
freqz(b,a); %滤波器频谱特性
figure(3);
subplot(3,1,1);
plot(t,filter_lp_s);
grid on;
title('低通滤波后时域图形');
subplot(3,1,2);
plot(f,X_lp_s);
title('低通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_lp_s_angle);
title('低通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Aiv7LRqY-1573631797432)(G:\研究生\项目小组任务\笔记\第四周笔记\lowp1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/201911131557578.jpg)
#### 高通滤波器
```matlab
%设计一个高通滤波器,要求把400Hz的频率分量保留,其他分量滤掉
wp = 350/(fs/2);  %通带截止频率,取200~400中间的值,并对其归一化
ws = 380/(fs/2);  %阻带截止频率,取200~400中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 40;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N2 wc2 ] = cheb2ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby2(N2,alpha_s,wc2,'high');
%滤波
filter_hp_s = filter(b,a,x);
X_hp_s = fftshift(abs(fft(filter_hp_s)))/N;
X_hp_s_angle = fftshift(angle(fft(filter_hp_s)));
figure(4);
freqz(b,a); %滤波器频谱特性
figure(5);
subplot(3,1,1);
plot(t,filter_hp_s);
grid on;
title('高通滤波后时域图形');
subplot(3,1,2);
plot(f,X_hp_s);
title('高通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_hp_s_angle);
title('高通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-PzagABKE-1573631797433)(G:\研究生\项目小组任务\笔记\第四周笔记\hightp1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113155827615.jpg)
#### 带通滤波器
```matlab
%设计一个带通滤波器,要求把50Hz和400Hz的频率分量滤掉,其他分量保留
wp = [65 385 ] / (fs/2);  %通带截止频率,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 40;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N3 wn ] = cheb2ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby2(N3,alpha_s,wn,'bandpass');
%滤波
filter_bp_s = filter(b,a,x);
X_bp_s = fftshift(abs(fft(filter_bp_s)))/N;
X_bp_s_angle = fftshift(angle(fft(filter_bp_s)));
figure(6);
freqz(b,a); %滤波器频谱特性
figure(7);
subplot(3,1,1);
plot(t,filter_bp_s);
grid on;
title('带通滤波后时域图形');
subplot(3,1,2);
plot(f,X_bp_s);
title('带通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bp_s_angle);
title('带通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-oNpbpAdi-1573631797434)(G:\研究生\项目小组任务\笔记\第四周笔记\bandp1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113155914163.jpg)
#### 带阻滤波器
```matlab
%设计一个带阻滤波器,要求把50Hz和400Hz的频率分量保留,其他分量滤掉
wp = [65 385 ] / (fs/2);  %通带截止频率?,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率?,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 40;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N4 wn ] = cheb2ord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = cheby2(N4,alpha_s,wn,'stop');
%滤波
filter_bs_s = filter(b,a,x);
X_bs_s = fftshift(abs(fft(filter_bs_s)))/N;
X_bs_s_angle = fftshift(angle(fft(filter_bs_s)));
figure(8);
freqz(b,a); %滤波器频谱特性
figure(9);
subplot(3,1,1);
plot(t,filter_bs_s);
grid on;
title('带阻滤波后时域图形');
subplot(3,1,2);
plot(f,X_bs_s);
title('带阻滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bs_s_angle);
title('带阻滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-hPjWzOis-1573631797436)(G:\研究生\项目小组任务\笔记\第四周笔记\bands1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113155954292.jpg)
### 椭圆滤波器设计

椭圆滤波器（Elliptic filter）又称考尔滤波器（Cauer filter），是在通带和阻带等波纹的一种滤波器。椭圆滤波器相比其他类型的滤波器，在阶数相同的条件下有着最小的通带和阻带波动。它在通带和阻带的波动相同，这一点区别于在通带和阻带都平坦的巴特沃斯滤波器，以及通带平坦、阻带等波纹或是阻带平坦、通带等波纹的切比雪夫滤波器。

椭圆滤波器特点：

 从传递函数来看，巴特沃斯和切比雪夫滤波器的传输函数都是一个常数除以一个多项式, 为全极点网络, 仅在无限大阻带处衰减为无限大. 而椭圆函数滤波器在有限频率上既有零点又有极点。极零点在通带内产生等波纹, 阻带内的有限传输零点减少了过渡区, 可获得极为陡峭的衰减曲线。也就是说在阶数相同的条件下,椭圆滤波器相比于其他类型的滤波器，能获得更窄的过渡带宽和较小的阻带波动, 就这点而言, 椭圆滤波器是最优的。它陡峭的过渡带特性是用通带和阻带的起伏为代价来换取的，并且在通带和阻带的波动相同，这一点区别于在通带和阻带都平坦的巴特沃斯滤波器，以及通带平坦、阻带等波纹或是阻带平坦、通带等波纹的切比雪夫滤波器。

- 椭圆低通滤波器是一种零、极点型滤波器，它在有限频率范围内存在传输零点和极点。

- 椭圆低通滤波器的通带和阻带都具有等波纹特性，因此通带，阻带逼近特性良好。

- 对于同样的性能要求，它比前两种滤波器所需用的阶数都低，而且它的过渡带比较窄。

但是椭圆滤波器传输函数是一种较复杂的逼近函数,利用传统的设计方法进行电路网络综合要进行繁琐的计算, 还要根据计算结果进行查表, 整个设计， 调整都十分困难和繁琐。而用MATLAB设计椭圆滤波器可以大大简化设计过程。

**原始信号设定**
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  EllipticFilter.m
%  椭圆滤波器的设计
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
clear;
close all;
clc;
 
fs = 1000; %Hz 采样频率
Ts = 1/fs;
N  = 1000; %序列长度
t = (0:N-1)*Ts;
delta_f = 1*fs/N;
f1 = 50;
f2 = 100;
f3 = 200;
f4 = 400;
x1 = 2*0.5*sin(2*pi*f1*t);
x2 = 2*0.5*sin(2*pi*f2*t);
x3 = 2*0.5*sin(2*pi*f3*t);
x4 = 2*0.5*sin(2*pi*f4*t);
x = x1 + x2 + x3 + x4; %待处理信号由四个分量组成
 
X = fftshift(abs(fft(x)))/N;
X_angle = fftshift(angle(fft(x)));
f = (-N/2:N/2-1)*delta_f;
 
figure(1);
subplot(3,1,1);
plot(t,x);
title('原信号');
subplot(3,1,2);
plot(f,X);
grid on;
title('原信号频谱幅度特性');
subplot(3,1,3);
plot(f,X_angle);
title('原信号频谱相位特性');
grid on;
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-iKUJEDKw-1573632215791)(G:\研究生\项目小组任务\笔记\第四周笔记\qubify3.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113160415640.jpg)
#### 低通滤波器
```matlab
%设计一个椭圆滤波器低通滤波器,要求把50Hz的频率分量保留,其他分量滤掉
wp = 55/(fs/2);  %通带截止频率,取50~100中间的值,并对其归一化
ws = 60/(fs/2);  %阻带截止频率,取50~100中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为 db
alpha_s = 40;%阻带允许最小衰减为 db
%获取阶数和截止频率
[ N1 wc1 ] = ellipord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = ellip(N1,alpha_p,alpha_s,wc1,'low');
%滤波
filter_lp_s = filter(b,a,x);
X_lp_s = fftshift(abs(fft(filter_lp_s)))/N;
X_lp_s_angle = fftshift(angle(fft(filter_lp_s)));
figure(2);
freqz(b,a); %滤波器频谱特性
figure(3);
subplot(3,1,1);
plot(t,filter_lp_s);
grid on;
title('低通滤波后时域图形');
subplot(3,1,2);
plot(f,X_lp_s);
title('低通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_lp_s_angle);
title('低通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-SkW35Ytr-1573632215793)(G:\研究生\项目小组任务\笔记\第四周笔记\lowp3.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113160442115.jpg)
#### 高通滤波器
```matlab
%设计一个高通滤波器,要求把400Hz的频率分量保留,其他分量滤掉
wp = 350/(fs/2);  %通带截止频率,取200~400中间的值,并对其归一化
ws = 380/(fs/2);  %阻带截止频率,取200~400中间的值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 40;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N2 wc2 ] = ellipord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = ellip(N2,alpha_p,alpha_s,wc2,'high');
%滤波
filter_hp_s = filter(b,a,x);
X_hp_s = fftshift(abs(fft(filter_hp_s)))/N;
X_hp_s_angle = fftshift(angle(fft(filter_hp_s)));
figure(4);
freqz(b,a); %滤波器频谱特性
figure(5);
subplot(3,1,1);
plot(t,filter_hp_s);
grid on;
title('高通滤波后时域图形');
subplot(3,1,2);
plot(f,X_hp_s);
title('高通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_hp_s_angle);
title('高通滤波后频域相位特性');
 
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-qylLrvNL-1573632215794)(G:\研究生\项目小组任务\笔记\第四周笔记\hightp3.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113160507563.jpg)
#### 带通滤波器
```matlab
%设计一个带通滤波器,要求把50Hz和400Hz的频率分量滤掉,其他分量保留
wp = [65 385 ] / (fs/2);  %通带截止频率,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 40;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N3 wn ] = ellipord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = ellip(N3,alpha_p,alpha_s,wn,'bandpass');
%滤波
filter_bp_s = filter(b,a,x);
X_bp_s = fftshift(abs(fft(filter_bp_s)))/N;
X_bp_s_angle = fftshift(angle(fft(filter_bp_s)));
figure(6);
freqz(b,a); %滤波器频谱特性
figure(7);
subplot(3,1,1);
plot(t,filter_bp_s);
grid on;
title('带通滤波后时域图形');
subplot(3,1,2);
plot(f,X_bp_s);
title('带通滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bp_s_angle);
title('带通滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-lL9qP9Ue-1573632215795)(G:\研究生\项目小组任务\笔记\第四周笔记\bandp3.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113160611172.jpg)
#### 带阻滤波器
```matlab
%设计一个带阻滤波器,要求把50Hz和400Hz的频率分量保留,其他分量滤掉
wp = [65 385 ] / (fs/2);  %通带截止频率?,50~100、200~400中间各取一个值,并对其归一化
ws = [75 375 ] / (fs/2);  %阻带截止频率?,50~100、200~400中间各取一个值,并对其归一化
alpha_p = 3; %通带允许最大衰减为  db
alpha_s = 40;%阻带允许最小衰减为  db
%获取阶数和截止频率
[ N4 wn ] = ellipord( wp , ws , alpha_p , alpha_s);
%获得转移函数系数
[ b a ] = ellip(N4,alpha_p,alpha_s,wn,'stop');
%滤波
filter_bs_s = filter(b,a,x);
X_bs_s = fftshift(abs(fft(filter_bs_s)))/N;
X_bs_s_angle = fftshift(angle(fft(filter_bs_s)));
figure(8);
freqz(b,a); %滤波器频谱特性
figure(9);
subplot(3,1,1);
plot(t,filter_bs_s);
grid on;
title('带阻滤波后时域图形');
subplot(3,1,2);
plot(f,X_bs_s);
title('带阻滤波后频域幅度特性');
subplot(3,1,3);
plot(f,X_bs_s_angle);
title('带阻滤波后频域相位特性');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-0Dfzma24-1573632215795)(G:\研究生\项目小组任务\笔记\第四周笔记\bands3.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113160656954.jpg)
### 四种IIR滤波器纹波特性对比
数字IIR滤波器一般是基于传递函数为$$H(s)$$的典型Bessel、Butterworth、一类Cheby-shev、二类Chebyshev以及Cauer（椭圆函数）模拟滤波器模型。过去在这五类滤波器中模拟Bessel滤波器具有最为平坦的群延时特性。不过，Bessel滤波器在相位线性方面的性能不如FIR滤波器，因雨在设计具有平坦群延时的数字滤波器时一般不考虑这类模型。IIR设计中主要考虑剩下的四种模拟滤波器模型：Butterworth，一类Chebyshev，二类Chebyshev以及Cauer（椭圆）滤波器。这四类模型下滤波器的幅频响应将会在接下来进行逐一分析。选择使用哪类模型是设计者的任务。

- 一般认为对于给定的滤波器指标，椭圆滤波器所需的阶数最少，接下来是一类和二类Chebyshev，最后是Butterworth。

- Butterworth滤波器具有平滑的通带和阻带，一类Chebyshev通带有纹波，二类Chebyshev阻带有纹波，而椭圆滤波器在通带和阻带均有纹波。接下来将会通过程序对四种滤波器详细进行分析。

#### 低通滤波器
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%FilterCompare.m
%对比相同阶数时四种IIR滤波器的波纹特性
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
close all;
clear;
clc;
fs = 1000; %Hz

%低通滤波器对比
N1 = 10;
wp = 50 / ( fs / 2);
ws = 100 / ( fs / 2);
alpha_p = 1;
alpha_s = 20;
[ b1,a1] = butter( N1 , ws , 'low' );
[ b2,a2] = cheby1( N1 , alpha_p , ws , 'low' );
[ b3,a3] = cheby2( N1 , alpha_s , ws , 'low' );
[ b4,a4] = ellip ( N1 , alpha_p,alpha_s , ws , 'low' );
[H1,w1] = freqz(b1,a1,1024*4);
[H2,w2] = freqz(b2,a2,1024*4);
[H3,w3] = freqz(b3,a3,1024*4);
[H4,w4] = freqz(b4,a4,1024*4);
w1 = w1/pi *fs/2;
w2 = w2/pi *fs/2;
w3 = w3/pi *fs/2;
w4 = w4/pi *fs/2;
figure(1);
plot(w1,abs(H1),'black','linewidth',0.5);
hold on;
plot(w2,abs(H2),'red','linewidth',0.5);
plot(w3,abs(H3),'green','linewidth',0.5);
plot(w4,abs(H4),'blue','linewidth',0.5);
xlim([0 500]);
ylim([0 1.1]);
legend({ 'butter' , 'cheby1' , 'cheby2' , 'ellip'});
title('同阶数(N=10),同截止频率(f_c=100Hz)的低通滤波器对比');
 
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wR9noXjY-1573634461133)(G:\研究生\项目小组任务\笔记\第四周笔记\lowp4.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/2019111316425313.jpg)

#### 高通滤波器
```matlab

%高通滤波器
N1 = 10;
wp = 400 / ( fs / 2);
ws = 400 / ( fs / 2);
alpha_p = 1;
alpha_s = 20;
[ b1,a1] = butter( N1 , ws , 'high' );
[ b2,a2] = cheby1( N1 , alpha_p , ws , 'high' );
[ b3,a3] = cheby2( N1 , alpha_s , ws , 'high' );
[ b4,a4] = ellip( N1 , alpha_p,alpha_s , ws , 'high' );
[H1,w1] = freqz(b1,a1,1024*4);
[H2,w2] = freqz(b2,a2,1024*4);
[H3,w3] = freqz(b3,a3,1024*4);
[H4,w4] = freqz(b4,a4,1024*4);
w1 = w1/pi *fs/2;
w2 = w2/pi *fs/2;
w3 = w3/pi *fs/2;
w4 = w4/pi *fs/2;
figure(2);
plot(w1,abs(H1),'black','linewidth',0.5);
hold on;
plot(w2,abs(H2),'red','linewidth',0.5);
plot(w3,abs(H3),'green','linewidth',0.5);
plot(w4,abs(H4),'blue','linewidth',0.5);
xlim([0 500]);
ylim([0 1.1]);
legend({ 'butter' , 'cheby1' , 'cheby2' , 'ellip'});
title('同阶数(N=10),同截止频率(f_c=400Hz)的高通滤波器对比');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wR9noXjY-1573634461133)(G:\研究生\项目小组任务\笔记\第四周笔记\lowp4.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113164536219.jpg)



#### 带通滤波器

```matlab
%带通滤波器
 
N1 = 10;
wp = [ 100 , 400 ] / ( fs / 2);
ws = [ 100 , 400 ] / ( fs / 2);
alpha_p = 1;
alpha_s = 20;
[ b1,a1] = butter( N1 , ws , 'bandpass' );
[ b2,a2] = cheby1( N1 , alpha_p , ws , 'bandpass' );
[ b3,a3] = cheby2( N1 , alpha_s , ws , 'bandpass' );
[ b4,a4] = ellip( N1 , alpha_p,alpha_s , ws , 'bandpass' );
[H1,w1] = freqz(b1,a1,1024*4);
[H2,w2] = freqz(b2,a2,1024*4);
[H3,w3] = freqz(b3,a3,1024*4);
[H4,w4] = freqz(b4,a4,1024*4);
w1 = w1/pi *fs/2;
w2 = w2/pi *fs/2;
w3 = w3/pi *fs/2;
w4 = w4/pi *fs/2;
figure(3);
plot(w1,abs(H1),'black','linewidth',0.5);
hold on;
plot(w2,abs(H2),'red','linewidth',0.5);
plot(w3,abs(H3),'green','linewidth',0.5);
plot(w4,abs(H4),'blue','linewidth',0.5);
xlim([0 500]);
ylim([0 1.1]);
legend({ 'butter' , 'cheby1' , 'cheby2' , 'ellip'});
title('同阶数(N=10),同截止频率(f_c_1=100Hz f_c_2 = 400Hz)的带通滤波器对比');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-k9WsXwWk-1573634461137)(G:\研究生\项目小组任务\笔记\第四周笔记\bandp4.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113164608903.jpg)

#### 带阻滤波器
```matlab
%带阻滤波器
N1 = 10;
wp = [ 100 , 400 ] / ( fs / 2);
ws = [ 100 , 400 ] / ( fs / 2);
alpha_p = 1;
alpha_s = 20;
[ b1,a1] = butter( N1 , ws , 'stop' );
[ b2,a2] = cheby1( N1 , alpha_p , ws , 'stop' );
[ b3,a3] = cheby2( N1 , alpha_s , ws , 'stop' );
[ b4,a4] = ellip( N1 , alpha_p,alpha_s , ws , 'stop' );
[H1,w1] = freqz(b1,a1,1024*4);
[H2,w2] = freqz(b2,a2,1024*4);
[H3,w3] = freqz(b3,a3,1024*4);
[H4,w4] = freqz(b4,a4,1024*4);
w1 = w1/pi *fs/2;
w2 = w2/pi *fs/2;
w3 = w3/pi *fs/2;
w4 = w4/pi *fs/2;
figure(4);
plot(w1,abs(H1),'black','linewidth',0.5);
hold on;
plot(w2,abs(H2),'red','linewidth',0.5);
plot(w3,abs(H3),'green','linewidth',0.5);
plot(w4,abs(H4),'blue','linewidth',0.5);
xlim([0 500]);
ylim([0 1.1]);
legend({ 'butter' , 'cheby1' , 'cheby2' , 'ellip'});
title('同阶数(N=10),同截止频率(f_c_1=100Hz f_c_2 = 400Hz)的带阻滤波器对比');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-kF5nV6Hx-1573634461138)(G:\研究生\项目小组任务\笔记\第四周笔记\bands4.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191113164640914.jpg)

#### 总结
**1、巴特沃斯滤波器的特点：**

巴特沃斯滤波器特点是通频带内的频率响应曲线最大限度平坦，没有起伏，而在阻频带则逐渐下降为零。 在振幅的对数对角频率的波特图上，从某一边界角频率开始，振幅随着角频率的增加而逐步减少,趋向负无穷大。

**巴特沃斯滤波器优点:**

巴特沃斯滤波器的特点是通频带内的频率响应曲线最大限度平坦，没有起伏，而在阻频带则逐渐下降为零。在振幅的对数对角频率的波得图上，从某一边界角频率开始，振幅随着角频率的增加而逐渐减少，趋向负无穷大。

一阶巴特沃斯滤波器的衰减率为每倍频6分贝，每十倍频20分贝。二阶巴特沃斯滤波器的衰减率为每倍频12分贝，三阶巴特沃斯滤波器的衰减率为每倍频18分贝，如此类推。巴特沃斯滤波器的振幅对角频率单调下降，并且也是唯一的无论阶数、振幅对角频率曲线都保持同样的形状的滤波器。只不过滤波器阶数越高，在阻频带振幅衰减速度越快。其他滤波器高阶的振幅对角频率图和低级数的振幅对角频率有不同的形状。

**巴特沃斯滤波器缺点:**

巴特沃斯滤波器是滤波器的一种设计分类，类同于切比雪夫滤波器，它有高通，低通，带通，高通，带阻等多种滤波器。它在通频带内外都有平稳的幅频特性，但有较长的过渡带，在过渡带上很容易造成失真，在调用MATLAB里的巴特沃斯滤波器做仿真时，信号总会在第一个周期略微有些失真。但往后的幅频特性就非常的好。

巴特沃斯滤波器的通带和阻带均是单调变化，频率响应最为平滑，若通带边缘满足指标要求，则通带内会有富余量，并不经济，更有效的方法是将指标的精度要求均匀分布在通带或阻带内，这样能设计出阶数较低的滤波器；

**2、切比雪夫Ⅰ型滤波器特点：**

切比雪夫滤波器在过渡带比巴特沃斯滤波器的衰减快，但频率响应的幅频特性不如后者平坦。切比雪夫滤波器和理想滤波器的频率响应曲线之间的误差最小，但是在通频带内存在幅度波动。

1、幅度特性是在一个频带内（通带或阻带）范围内具有等波纹特性；

2、Ⅰ型在通带范围内是等波纹的，在阻带范围内是单调的。

**3、切比雪夫Ⅱ型滤波器特点：**

1、幅度特性是在一个频带内（通带或阻带）范围内具有等波纹特性；

2、Ⅱ型在通带范围内是单调的，在阻带范围内是等波纹的。

**4、椭圆滤波器特点：**

椭圆滤波器特点：

从传递函数来看，巴特沃斯和切比雪夫滤波器的传输函数都是一个常数除以一个多项式, 为全极点网络, 仅在无限大阻带处衰减为无限大. 而椭圆函数滤波器在有限频率上既有零点又有极点。极零点在通带内产生等波纹, 阻带内的有限传输零点减少了过渡区, 可获得极为陡峭的衰减曲线。也就是说在阶数相同的条件下,椭圆滤波器相比于其他类型的滤波器，能获得更窄的过渡带宽和较小的阻带波动, 就这点而言, 椭圆滤波器是最优的。它陡峭的过渡带特性是用通带和阻带的起伏为代价来换取的，并且在通带和阻带的波动相同，这一点区别于在通带和阻带都平坦的巴特沃斯滤波器，以及通带平坦、阻带等波纹或是阻带平坦、通带等波纹的切比雪夫滤波器。

椭圆低通滤波器是一种零、极点型滤波器，它在有限频率范围内存在传输零点和极点。

椭圆低通滤波器的通带和阻带都具有等波纹特性，因此通带，阻带逼近特性良好。

对于同样的性能要求，它比前两种滤波器所需用的阶数都低，而且它的过渡带比较窄。

但是椭圆滤波器传输函数是一种较复杂的逼近函数,利用传统的设计方法进行电路网络综合要进行繁琐的计算, 还要根据计算结果进行查表, 整个设计， 调整都十分困难和繁琐。而用MATLAB设计椭圆滤波器可以大大简化设计过程。

## FIR滤波器设计
### FIR滤波器的结构
FIR(Finite Impulse Response)滤波器：有限长单位冲激响应滤波器，又称为非递归型滤波器，是一种在数字信号领域应用非常广泛的基础型滤波器。FIR滤波器的特点是能够在输入具体任意幅频特性的数字信号后，保证输出数字信号的相频特性仍然保持严格线性。另外FIR滤波器是数字信号处理系统中最基本的元件，它可以在保证任意幅频特性的同时具有严格的线性相频特性，同时具有有限长的脉冲采样响应特性，因而滤波器是稳定的系统。因此，FIR滤波器的应用要远胜于IIR滤波器，在通信、图像处理、模式识别等领域都有着广泛而举足轻重的作用。

**FIR滤波器的结构：**

尽管IIR数字滤波器的设计理论已经非常成熟、经典，但是IIR滤波器有一个自身的中要缺陷：相位特性通常是非线性的。

- IIR滤波器的非线性原理：在IIR滤波器的滤波器设计中，只是对滤波器的幅频特性进行了研究，并获得了良好的幅频特性。但对相频特性却没有考虑，所以IIR滤波器的相频特性通常是非线性的。
- IIR滤波器的应用问题：由于IIR滤波器的相位特性通常是非线性的，所以它适合用于在对系统相位特性要求不严格的场合。但是另一方面，由于一个具有线性相位特性的滤波器可以保证在滤波器通带内信号传输不失真，所以在许多领域需要滤波器具有严格得线性相位特性，比如图像处理以及数据传输等。但是如果要使用IIR滤波器实现线性的相位特性，则必须对其相位特性用全通滤波器进行校正，其结果使得滤波器设计变得非常复杂，实现困难成本提高。所以，要实现具有线性相位的数字滤波器，必须另辟蹊径。
- 有限脉冲响应系统的单位脉冲响应`$h(s)$`为有限长序列，系统函数`$H(z)$`在有限z平面上不存在几点，其运算结构中没有反馈支路，即没有环路。所以，有限脉冲响应滤波器可以设计成在整个频率范围内均可以提供精确的线性相位，而且总是可以独立于滤波器系数保持有限长输入有限长输出的稳定。因此，这样的滤波器在很多领域是首选的。

**FIR滤波器的特点**

有限长单位冲激响应（FIR）滤波器有以下特点：

- 系统的单位冲激响应h (n)在有限个n值处不为零
- 系统函数H(z)在|z|>0处收敛，极点全部在z = 0处（因果系统）
- 结构上主要是非递归结构，没有输出到输入的反馈

#### 直接型与级联型
- 直接型:
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-xTYGXjLS-1573745391892)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\截图20191114230732.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/2019111423312397.jpg)
- 级联型:
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-vfmwWIuD-1573745391896)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\截图20191114230814.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191114233145294.jpg)

特点：

- 每个基本节控制一对零点--便于控制滤波器的传输零点
- 系数比直接型多--所需的乘法运算多。


```matlab
clear all;
n=0:10;
N=30;
b=0.9.^n;
delta=impseq(0,0,N);%脉冲系列生成器
h=filter(b,1,delta);%其中b是分子系数向量，a是分母系数向量。
x=[ones(1,5),zeros(1,N-5)];
y=filter(b,1,x);
subplot(2,2,1);stem(h);%绘制火柴图
title('直接型h(n)');
subplot(2,2,2);stem(y);
title('直接型y(n)');
[b0,B,A]=dir2cas(b,1);
h=casfilter(b0,B,A,delta);%级联型单位脉冲响应
y=casfilter(b0,B,A,x);
subplot(2,2,3);stem(h);
title('级联型h(n)');
subplot(2,2,4);stem(y);
title('级联型y(n)');

%%impseq函数设计生成m文件放入当前文件夹：
function [x,n] = impseq(n0,n1,n2)
% Generates x(n) = delta(n-n0); n1 <= n,n0 <= n2
% ----------------------------------------------
% [x,n] = impseq(n0,n1,n2)
%
if ((n0 < n1) | (n0 > n2) | (n1 > n2))
	error('arguments must satisfy n1 <= n0 <= n2')
end
n = [n1:n2];
%x = [zeros(1,(n0-n1)), 1, zeros(1,(n2-n0))];
x = [(n-n0) == 0];

%%dir2cas函数设计生成m文件放入当前文件夹：
function [b0,B,A] = dir2cas(b,a)
% 直接型到级联型的型式转换(复数对型)
% [b0,B,A] = dir2cas(b,a)
% b = 直接型的分子多项式系数
% a = 直接型的分母多项式系数
% b0 = 增益系数
% B = 包含各bk的K乘3维实系数矩阵
% A = 包含各ak的K乘3维实系数矩阵
% compute gain coefficient b0
b0 = b(1); b = b/b0;
a0 = a(1); a = a/a0;
b0 = b0/a0;
%
M = length(b); N = length(a);
if N > M
	b = [b zeros(1,N-M)];
elseif M > N
	a = [a zeros(1,M-N)]; N = M;
else
	NM = 0;
end
%
K = floor(N/2); B = zeros(K,3); A = zeros(K,3);
if K*2 == N;
	b = [b 0];
	a = [a 0];
end
%        
broots = cplxpair(roots(b));
aroots = cplxpair(roots(a));
for i=1:2:2*K
	Brow = broots(i:1:i+1,:);
	Brow = real(poly(Brow));
	B(fix((i+1)/2),:) = Brow;
	Arow = aroots(i:1:i+1,:);
	Arow = real(poly(Arow));
	A(fix((i+1)/2),:) = Arow;
end     

%%casfilter函数设计生成m文件放入当前文件夹：
function y = casfilter(b0,B,A,x)
% CASCADE form realization of IIR and FIR filters
% -----------------------------------------------
% y = casfiltr(b0,B,A,x);
%  y = output sequence
% b0 = gain coefficient of CASCADE form
%  B = K by 3 matrix of real coefficients containing bk's
%  A = K by 3 matrix of real coefficients containing ak's
%  x = input sequence
%
[K,L] = size(B);
N = length(x);
w = zeros(K+1,N);
w(1,:) = x;
for i = 1:1:K
        w(i+1,:) = filter(B(i,:),A(i,:),w(i,:));
end
y = b0*w(K+1,:);
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wyQ1ZD5y-1573745391900)(G:\研究生\项目小组任务\程序设计\滤波器设计\first.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191114233316191.jpg)
#### 快速卷积型
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Ss7vEm1J-1573745391897)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\截图20191114230922.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191114233207940.jpg)

运用FFT实现有限长序列x ( n ) x(n)x(n)与h ( x ) h(x)h(x)的线性卷积，则可以得到FIR滤波器的快速卷积结构如图所示，对于x ( n ) x(n)x(n)的无限长序列的一般情况，可以采用重叠相加法或者重叠保留法实现FIR滤波器的快速卷积结构
#### 频率采样型
FIR系统直接型转换为频率采样型结构的Matlab实现源代码：
```matlab
function [C,B,A] = dir2fs(h)
% 直接型到频率采样型的转换
% [C,B,A] = dir2fs(h)
% C = 包含各并行部分增益的行向量
% B = 包含按行排列的分子系数矩阵
% A = 包含按行排列的分母系数矩阵
% h =  FIR滤波器的脉冲响应向量
M = length(h);
H = fft(h,M);
magH = abs(H); phaH = angle(H)';
% check even or odd M
if (M == 2*floor(M/2))
      L = M/2-1;   %  M为偶数 
     A1 = [1,-1,0;1,1,0];
     C1 = [real(H(1)),real(H(L+2))];
 else
      L = (M-1)/2; % M is odd
     A1 = [1,-1,0];
     C1 = [real(H(1))];
 end
k = [1:L]';
% 初始化 B 和 A 数组
B = zeros(L,2); A = ones(L,3);
% 计算分母系数
A(1:L,2) = -2*cos(2*pi*k/M); A = [A;A1];
% 计算分子系数
B(1:L,1) = cos(phaH(2:L+1));
B(1:L,2) = -cos(phaH(2:L+1)-(2*pi*k/M));
% 计算增益系数
C = [2*magH(2:L+1),C1]';

```
案例分析：
```matlab
%[例6-1]
%%利用频率采样法设计一个低通FIR数字低通滤波器，其理想频率特性是矩形的
%pi=3.14
%给定抽样频率为Ωs=2*pi*1.5*10^4(rad/sec),通带截至频率为Ωp=2*pi*1.6*10^3(rad/sec),
%阻带截至频率为Ωst=2*pi*3.1*10^3(rad/sec),通带波动<=1dB ,阻带衰减>=50dB。
%通带的截至频率为：w_p = Ωp/f_s = 2*pi Ωp/Ωs = 0.213*pi
%阻带的起始频率为：w_st = Ωst/f_s = 2*pi Ωfs/Ωs = 0.413*pi
%理想低通截至频率：Ωc = 1/2(Ωp+Ωst) = 2*pi*2.35*10^3(rad/sec)
%其对应的数字频率：w_c = 2*pi Ωc/Ωs 0.313*pi
%过渡带带宽为：△w = w_st - w_p =0.2*pi  由于△w = (2*pi/N) *3 所以抽样频率为30rad/sec
% 直接型到频率采样型的转换
close all;
clear;
N=30;
H=[ones(1,4),zeros(1,22),ones(1,4)];
H(1,5)=0.5886;H(1,26)=0.5886;H(1,6)=0.1065;H(1,25)=0.1065;
k=0:(N/2-1);k1=(N/2+1):(N-1);k2=0;
A=[exp(-j*pi*k*(N-1)/N),exp(-j*pi*k2*(N-1)/N),exp(j*pi*(N-k1)*(N-1)/N)];
HK=H.*A;
h=ifft(HK);
fs=15000;
[c,f3]=freqz(h,1);
f3=f3/pi*fs/2;
subplot(221);
plot(f3,20*log10(abs(c)));
title('频谱特性');
xlabel('频率/HZ');ylabel('衰减/dB');
grid on;
subplot(222);
title('输入采样波形');
stem(real(h),'.');
line([0,35],[0,0]);
xlabel('n');ylabel('Real(h(n))');
grid on;
t=(0:100)/fs;
W=sin(2*pi*t*750)+sin(2*pi*t*3000)+sin(2*pi*t*6500);
q=filter(h,1,W);
[a,f1]=freqz(W);
f1=f1/pi*fs/2;
[b,f2]=freqz(q);
f2=f2/pi*fs/2;
subplot(223);
plot(f1,abs(a));
title('输入波形频谱图');
xlabel('频率');ylabel('幅度')
grid on;
subplot(224);
plot(f2,abs(b));
title('输出波形频谱图');
xlabel('频率');ylabel('幅度')
grid on;
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-03u5QQ1I-1573745391902)(G:\研究生\项目小组任务\程序设计\滤波器设计\secord.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191114233342125.jpg)
### 线性相位滤波器的特性
FIR滤波器能够在保证幅度特性满足技术要求的同时，容易实现严格的线性相位特性，且FIR滤波器的单位抽样响应是有限长的，因而滤波器一定是稳定的，而且可以用快速傅里叶变换算法实现，大大提高了运算速率。

同时只要经过一定的延时，任何非因果有限长序列都能变成因果的有限长序列，所以系统总能用因果系统来实现。但是FIR滤波器必须用很长的冲击响应滤波器才能很好的逼近瑞截至的滤波器，需要很大的运算量：而且要取得很好的衰减特性，需要较高的阶次。

**线性相位FIR滤波器相位条件**：
- FIR滤波器具有第一类线性相位的充分必要条件如下：

单位抽样响应$$h(n)$$关于群延时τ偶称对，即满足：
$$
h(n)=h(N−1−n)(0<=n<=N−1)\\

τ = ( N − 1 ) / 2
$$
满足偶对称条件的FIR滤波器分别为I型线性相位滤波器和II型线性相位滤波器。

- FIR滤波器具有第二类线性相位的充分必要条件如下：

单位抽样响应$$h(n)$$关于群延时$\tau$奇称对，即满足：
$$
h(n)=-h(N−1−n)(0<=n<=N−1)
$$

$$
τ = ( N − 1 ) / 2
$$

把满足奇对称条件的FIR滤波器分别为III型线性相位滤波器和IV型线性相位滤波器。

#### I型线性相位滤波器

上述滤波器可以通过下面的matlab程序设计实现：
```matlab
function [Hr,w,a,L]=hr_type1(h);
%计算所设计的1型滤波器的振幅响应
%Hr=振幅响应
%a=1型滤波器的系数
%L=Hr的阶次
%h=1型滤波器的单位冲击响应
M=length(h);
L=(M-1)/2;
a=[h(L+1) 2*h(L:-1:1)];
n=[0:1:L];
w=[0:1:500]'*2*pi/500;
Hr=cos(w*n)*a';
```
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%I型线性相位滤波器设计：
clear;
close all;
clc;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h=[-4 3 -5 -2  5 7 5 -2 -1 8 -3]
M=length(h);
n=0:M-1; 
[Hr,w,a,L]=hr_type1(h);
subplot(2,2,1);
stem(n,h); 
xlabel('n');
ylabel('h(n)');
title('脉冲响应')
grid on
subplot(2,2,3);
stem(0:L,a); 
xlabel('n');
ylabel('a(n)');
title('a(n)系数')
grid on
subplot(2,2,2); 
plot(w/pi,Hr);
xlabel('频率单位pi');ylabel('Hr');
title('I型幅度响应')
grid on
subplot(2,2,4);
pzplotz(h,1);
grid on

%在z平面上画出零极点分布图生产m文件存放当前文件夹
function pzplotz(b,a) 
%pzplotz(b,a)按给定系数向量b,a在z平面上画出零极点分布图
% b - 分子多项式系数向量
% a - 分母多项式系数向量
% a,b向量可从z的最高幂降幂排至z^0,也可由z^0开始,按z^-1的升幂排至z的最负幂.
N = length(a); 
M = length(b); 
pz = []; zz = []; 
if (N > M)      
zz = zeros((N-M),1); 
elseif (M > N)      
pz = zeros((M-N),1);  
end 
pz = [pz;roots(a)]; 
zz = [zz;roots(b)]; 
pzr = real(pz)'; 
pzi = imag(pz)'; 
zzr = real(zz)'; 
zzi = imag(zz)'; 
rzmin = min([pzr,zzr,-1])-0.5; 
rzmax = max([pzr,zzr,1])+0.5; 
izmin = min([pzi,zzi,-1])-0.5; 
izmax = max([pzi,zzi,1])+0.5; 
zmin = min([rzmin,izmin]); 
zmax = max([rzmax,izmax]); 
zmm=max(abs([zmin,zmax])); 
uc=exp(j*2*pi*[0:1:500]/500);
plot(real(uc),imag(uc),'b',[-zmm,zmm],[0,0],'b',[0,0],[-zmm,zmm],'b'); 
axis([-zmm,zmm,-zmm,zmm]);
axis('square');
hold on
plot(zzr,zzi,'bo',pzr,pzi,'rx');
hold on
text(zmm*1.1,zmm*0.95,'z-平面') 
xlabel('实轴');ylabel('虚轴');title('零极点图')

```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-2Kvvp70J-1573810752846)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hr_tyoe1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191115174021518.jpg)
#### II型线性相位滤波器
上述滤波器可以通过下面的matlab程序设计实现：
```matlab
function [Hr,w,b,L]=hr_type2(h)
%计算所设计的2型滤波器的振幅响应
%Hr=振幅响应
%b=2型滤波器的系数
%L=Hr的阶次
%h=2型滤波器的单位冲击响应
M=length(h);
L=M/2;
b= 2*h(L:-1:1);
n=[1:1:L];
n=n-0.5;
w=[0:1:500]'*2*pi/500;
Hr=cos(w*n)*b';
```
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2型线性相位滤波器设计：
clear;
close all;
clc;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h=[-3 2 -1 -2  5 6 5 -2 -1 1 -3]
M=length(h);
n=0:M-1; 
[Hr,w,b,L]=hr_type2(h);
subplot(2,2,1);
stem(n,h); 
xlabel('n');
ylabel('h(n)');
title('脉冲响应')
grid on
subplot(2,2,3);
stem(1:L,b); 
xlabel('n');
ylabel('a(n)');
title('a(n)系数')
grid on
subplot(2,2,2); 
plot(w/pi,Hr);
xlabel('频率单位pi');ylabel('Hr');
title('II型幅度响应')
grid on
subplot(2,2,4);
pzplotz(h,1);
grid on
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-zLE7jQSZ-1573810752848)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hr_type2.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191115174049721.jpg)
#### III型线性相位滤波器
上述滤波器可以通过下面的matlab程序设计实现：
```matlab
function [Hr,w,c,L]=hr_type3(h);
%计算所设计的3型滤波器的振幅响应
%Hr=振幅响应
%b=3型滤波器的系数
%L=Hr的阶次
%h=3型滤波器的单位冲击响应
M=length(h);
L=(M-1)/2;
c= [2*h(L+1:-1:1)];
n=[0:1:L];
w=[0:1:500]'*2*pi/500;
Hr=sin(w*n)*c';
```
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%3型线性相位滤波器设计：
clear;
close all;
clc;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h=[-3 1 -1 -2  5 6 5 -2 -1 1 -3]
M=length(h);
n=0:M-1; 
[Hr,w,c,L]=hr_type3(h);
subplot(2,2,1);
stem(n,h); 
xlabel('n');
ylabel('h(n)');
title('脉冲响应')
grid on
subplot(2,2,3);
stem(0:L,c); 
xlabel('n');
ylabel('c(n)');
title('c(n)系数')
grid on
subplot(2,2,2); 
plot(w/pi,Hr);
xlabel('频率单位pi');ylabel('Hr');
title('Ⅲ 型幅度响应')
grid on
subplot(2,2,4);
pzplotz(h,1);
grid on
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-bP86rRzB-1573810752850)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hr_type3.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191115174144245.jpg)
#### IV型线性相位滤波器
上述滤波器可以通过下面的matlab程序设计实现：
```matlab
function [Hr,w,d,L]=hr_type4(h); 
%计算所设计的4型滤波器的振幅响应
%Hr=振幅响应
%b=4型滤波器的系数
%L=Hr的阶次
%h=4型滤波器的单位冲击响应
M=length(h);
L=M/2;
d= 2*[h(L:-1:1)];
n=[1:1:L];
n=n-0.5;
w=[0:1:500]'*2*pi/500;
Hr=sin(w*n)*d';
```
```matlab
function [Hr,w,d,L]=hr_type4(h); 
%计算所设计的4型滤波器的振幅响应
%Hr=振幅响应
%b=4型滤波器的系数
%L=Hr的阶次
%h=4型滤波器的单位冲击响应
M=length(h);
L=M/2;
d= 2*[h(L:-1:1)];
n=[1:1:L];
n=n-0.5;
w=[0:1:500]'*2*pi/500;
Hr=sin(w*n)*d';
```
```matlab
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%4型线性相位滤波器设计：
clear;
close all;
clc;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
h=[-3 1 -1 -2  5 6 5 -2 -1 1 -3]
M=length(h);
n=0:M-1; 
[Hr,w,d,L]=hr_type4(h);
subplot(2,2,1);
stem(n,h); 
xlabel('n');
ylabel('h(n)');
title('脉冲响应')
grid on
subplot(2,2,3);
stem(1:L,d); 
xlabel('n');
ylabel('d(n)');
title('d(n)系数')
grid on
subplot(2,2,2); 
plot(w/pi,Hr);
xlabel('频率单位pi');ylabel('Hr');
title('Ⅳ型幅度响应')
grid on
subplot(2,2,4);
pzplotz(h,1);
grid on
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-o9TeMCcA-1573810752852)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hr_type4.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191115174121340.jpg)


**线性相位滤波器的零点特性：**

线性相位滤波器的零点有以下四种结构：

- 零点既不在实轴，也不在单位圆，四组零点是两种互为倒数的共轭对。
- 零点在单位圆，但不在实轴，零点的共轭值就是其倒数。
- 零点在实轴，但不在单位圆，此时零点是实数，它没有负共轭部分，只有倒数，倒数也在实轴上。
零点既在实轴，也在单位圆，此时零点就有两种情况，即z=1,z=−1,这时零点即是自己的负共轭，又是自己的倒数。

### 基本窗函数FIR滤波器设计
 IIR滤波器主要设计方法先设计一个模拟低通滤波器，然后把它转化为形式上的数字滤波器。但对于FIR滤波器来说，设计方法的关键要求之一就是保证线性相位条件。而IIR滤波器的设计方法中只对幅值特性进行设计，因此无法保证相位。所以FIR滤波器的设计需要采用完全不同的方法。FIR滤波器的设计方法主要有窗函数法、频率采样法、切比雪夫逼近法等。

 由于理想滤波器在边界频率处不连续，故时域信号$h_d(n)$一定是无限时宽的，也是非因果的。所以理想低通滤波器是无法实现的。如果实现一个具有理想线性相位特性的滤波器，其幅值特性只能采用逼近理想幅频特性的方法实现。如果对时域信号$h_d(n)$进行截取，并保证截取过程中序列保持对称，而且截取长度为N,则对称点为$α=\frac{1}{2}*(N-1)$。截取后序列为$h(n)$，则$h(n)$可用下式子表示：
$$
h(n) = h_d(n)*w(n)
$$
式中，$w(n)$为截取函数，又称为窗函数。如果窗函数为矩形序列，则称之为矩形窗。窗函数有多种形式，为保证加窗后系统的线性相位特性，必须保证加窗后序列关于$α=\frac{1}{2}*(N-1)$点对称。常用的窗函数有矩形窗、汉宁窗、汉明窗、布莱克曼窗、凯塞窗。窗函数设计法的基本思想是用一个长度为N的序列$h(n)$代替$h_d(n)$作为实际设计的滤波器的单位脉冲响应。这种设计法成为窗函数设计法。显然在保证$h(n)$对称性的前提下，窗函数长度N越长，则$h(n)$越接近$h_d(n)$。但是误差是肯定存在的，这种误差成为截断误差。

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-A0flZjTw-1573836815510)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\20170402112228645.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116005415661.jpg)

要确定如何设计一个FIR滤波器，首先得对加窗后的理想滤波器特性变化进行分析，并研究减少由截断引起的误差的途径，从而提出更好的滤波器设计方案。对于调整窗口长度可以有效地控制过渡带的宽度，但减少带内波动以及加大阻带衰减没有作用。所以必须挑选最为合适的窗函数对理想滤波器进行截取。下面简单介绍几种窗函数。一个实际的滤波器的单位脉冲响应可表示为：
$$
h(n)=h_d(n)∗w(n)
$$
几种常见窗函数（只给出了窗函数的定义和幅度特性）：
$$
 W(e^{j*w})=W(w)(e^{-jαw})
$$
#### 矩形窗FIR滤波器
矩形窗的窗函数为：
$$
w_R(n)=R_N(n)
$$
幅度函数为：
$$
R_N(w) = \frac{sin(wN/2)}{sin(w/2)}
$$
它的主瓣宽度为$4\pi/N$,第一瓣比主瓣地13dB.

在Matlab中，实现矩形窗的函数为boxcar和recttwin ,其调用格式如下：
```matlab
w=boxcar(N);
w=recttwin(N);
%%%显示窗函数的GUI工具
n = 60;
w = rectwin(n);
wvtool(w)%显示窗函数的GUI工具
%还提供了显示窗函数的GUI工具，如wvtool可以显示用来显示窗的形状和频域图形，wintool可以打开窗设计和分析工具，如运行
wvtool(hamming(64),hann(64),gausswin(64))
%%可以对比汉明窗、汉宁窗和高斯窗
```
其中，N是窗函数的长度，返回值w是一个N阶的向量，它的元素有窗函数的值组成。其中w=boxcar(N)等价于w=ones(N,1)。
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-eknDhIxt-1573836815512)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\20170402112307695.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116005442326.jpg)

案例分析：

利用矩形窗设计FIR带阻滤波器，主要参数如下:

给定抽样频率为$Ωs=2*pi*1.5*10^4(rad/sec)$,

通带截至频率为$Ωp1=2*pi*0.75*10^3(rad/sec),Ωp2=2*pi*6*10^3(rad/sec)$

阻带截至频率为$Ωst1=2*pi*2.25*10^3(rad/sec),Ωst2=2*pi*1.5*10^3(rad/sec)$

阻带衰减${\delta}_2 >=50dB$。

```matlab
%%%%调用子程序1：
function hd=ideal_bs(Wcl,Wch,m); 
alpha=(m-1)/2; 
n=[0:1:(m-1)];
m=n-alpha+eps; 
hd=[sin(m*pi)+sin(Wcl*m)-sin(Wch*m)]./(pi*m)
%%%%调用子程序2：
function[db,mag,pha,w]=freqz_m2(b,a)
[H,w]=freqz(b,a,1000,'whole');
H=(H(1:1:501))'; w=(w(1:1:501))';
mag=abs(H);
db=20*log10((mag+eps)/max(mag));
pha=angle(H);
%%%%运行MATLAB源代码如下：
clear all;
Wph=3*pi*6.25/15;%通带频率
Wpl=3*pi/15;
Wsl=3*pi*2.5/15;%阻带频率
Wsh=3*pi*4.75/15;
tr_width=min((Wsl-Wpl),(Wph-Wsh));%%过渡带带宽
%过渡带宽度
N=ceil(4*pi/tr_width);					%滤波器长度
n=0:1:N-1;
Wcl=(Wsl+Wpl)/2;						%理想滤波器的截止频率
Wch=(Wsh+Wph)/2;
hd=ideal_bs(Wcl,Wch,N);				%理想滤波器的单位冲击响应
w_ham=(boxcar(N))';
string=['矩形窗','N=',num2str(N)];
h=hd.*w_ham;						%截取取得实际的单位脉冲响应
[db,mag,pha,w]=freqz_m2(h,[1]);
%计算实际滤波器的幅度响应
delta_w=2*pi/1000;
subplot(241);
stem(n,hd);
title('理想脉冲响应hd(n)')
axis([-1,N,-0.5,0.8]);
xlabel('n');ylabel('hd(n)');
grid on
subplot(242);
stem(n,w_ham);
axis([-1,N,0,1.1]);
xlabel('n');ylabel('w(n)');
text(1.5,1.3,string);
grid on
subplot(243);
stem(n,h);title('实际脉冲响应h(n)');
axis([0,N,-1.4,1.4]);
xlabel('n');ylabel('h(n)');
grid on
subplot(244);
plot(w,pha);title('相频特性');
axis([0,3.15,-4,4]);
xlabel('频率（rad）');ylabel('相位（Φ）');
grid on
subplot(245);
plot(w/pi,db);title('幅度特性（dB）');
axis([0,1,-80,10]);
xlabel('频率（pi）');ylabel('分贝数');
grid on
subplot(246);
plot(w,mag);title('频率特性')
axis([0,3,0,2]);
xlabel('频率（rad）');ylabel('幅值');
grid on
fs=15000;
t=(0:100)/fs;
x=cos(2*pi*t*750)+cos(2*pi*t*3000)+cos(2*pi*t*6100);
q=filter(h,1,x);
[a,f1]=freqz(x);
f1=f1/pi*fs/2;
[b,f2]=freqz(q);
f2=f2/pi*fs/2;
subplot(247);
plot(f1,abs(a));
title('输入波形频谱图');
xlabel('频率');ylabel('幅度')
grid on
subplot(248);
plot(f2,abs(b));
title('输出波形频谱图');
xlabel('频率');ylabel('幅度')
grid on
```
![在这里插入图片描述](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/2019111601001834.jpg)
#### 汉宁窗FIR滤波器
汉宁窗（hanning window）又称升余弦窗，窗函数为：
$$
w_{Hn}(n) = 0.5[1-cos(\frac{2\pi*n}{N-1})]*R_N(n)
$$
幅值函数为：
$$
W_{Hn}(w) = 0.5W_R(w) + 0.25[W_R(w-\frac{2\pi}{N-1})+W_R(w+\frac{2\pi}{N-1})]
$$
汉宁窗幅度函数由3部分相加而成，其结果是使主瓣集中了更多能量，而旁瓣3部分相加时相互抵消而变小，其代价是主瓣宽度增加到$8\pi/N$。第一瓣比主瓣低31dB,阻带衰减加大。

在Matlab中，实现汉宁窗的函数为hanning和barthannwin ,其调用格式如下：
```matlab
w=hanning(N)
w=barthannwin(N)
```
案例1：绘制50个点的汉宁窗。
```matlab
N=49;n=1:N;
wdhn=hanning(N);	
figure(3);
stem(n,wdhn,'.');
grid on
axis([0,N,0,1.1]);
title('50点汉宁窗');
ylabel('W(n)');
xlabel('n');
title('50点汉宁窗');
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-KhfUUgrt-1573836815515)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanning_50point.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010107490.jpg)

案例2：已知连续信号为$x(t)=cos(2{\pi}f_1t) +0.15cos(2{\pi}f_2t)$，其中$f_1=100Hz,f_2=150Hz$。若抽样频率$f_sam=600Hz$对信号进行抽样，利用不同宽度N的矩形截断该序列，N取40，观察不同的窗对普分析结果的影响。

```matlab
N=40; 
L=512;
f1=100;f2=150;fs=600;
ws=2*pi*fs;
t=(0:N-1)*(1/fs);
x=cos(2*pi*f1*t)+0.25*sin (2*pi*f2*t);
wh=boxcar(N)';
x=x.*wh;
subplot(221);stem(t,x);
title('加矩形窗时域图');
xlabel('n');ylabel('h(n)')
grid on
W=fft(x,L);
f=((-L/2:L/2-1)*(2*pi/L)*fs)/(2*pi); 
subplot(222);
plot(f,abs(fftshift(W)))
title('加矩形窗频域图');
xlabel('频率');ylabel('幅度')
grid on
x=cos(2*pi*f1*t)+0.15*cos(2*pi*f2*t); 
wh=hanning(N)';
x=x.*wh;
subplot(223);stem(t,x);
title('加汉宁窗时域图');
xlabel('n');ylabel('h(n)')
grid on
W=fft(x,L);
f=((-L/2:L/2-1)*(2*pi/L)*fs)/(2*pi);
subplot(224);
plot(f,abs(fftshift(W)))
title('加汉宁窗频域图');
xlabel('频率');ylabel('幅度')
grid on
```

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wc7oZ6mR-1573836815515)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\rectange_6.8.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010213344.jpg)

用汉宁窗对谐波信号进行分析：

```matlab
clear; 
% 原始数据：直流:0V; 基波：49.5Hz,100V,10deg; HR2:0.5V,40deg;
hr0=0;f1=50.1; 
hr(1)=25*sqrt(2);deg(1)=10; 
hr(2)=0;deg(2)=0; 
hr(3)=1.755*sqrt(2);deg(3)=40; 
hr(4)=0;deg(4)=0; 
hr(5)=0.885*sqrt(2);deg(5)=70; 
hr(6)=0;deg(6)=0; 
hr(7)=1.125;deg(7)=110; 
M=7;f=[1:M]*f1;							%设定频率 
% 采样 
fs=10000; 
N=2048;									% 约10个周期 
T=1/fs; 
n=[0:N-1];t=n*T; 
x=zeros(size(t)); 
for k=1:M 
    x=x+hr(k)*cos(2*pi*f(k)*t+deg(k)*pi/180); 
end 
%分析： 
w=0.5-0.5*cos(2*pi*n/N);
Xk=fft(x.*w); 
amp=abs(Xk(1:N/2))/N*2;						%幅频 
pha=angle(Xk(1:N/2))/pi*180;					%相频 
for k=1:N/2 
    if(amp(k)<0.01) pha(k)=0;  %当谐波<10mV时，其相位=0 
    end 
    if(pha(k)<0) pha(k)=pha(k)+360;%调整到0-360度 
    end 
end 
fmin=fs/N; 
xaxis=fmin*n(1:N/2);
%横坐标为Hz 
kx=round([1:M]*50/fmin);
%各次谐波对应的下标(从0开始) 
for m=1:M 
    km(m)=searchpeaks(amp,kx(m)+1);			%km为谱峰(从1开始) 
    if(amp(km(m)+1)<amp(km(m)-1)) 
        km(m)=km(m)-1; 
    end 
    beta(m)=amp(km(m)+1)./amp(km(m)); 
    delta(m)=(2*beta(m)-1)./(1+beta(m)); 
end 
fx=(km-1+delta)*fmin;							%估计频率 
hrx=amp(km)*2.*pi.*delta.*(1-delta.*delta)./sin(pi*delta);
degx=pha(km)-delta.*180/N*(N-1);				%估计相位 
degx=mod(degx,360);							%调整到0-360度 
efx=(fx-f)./f*100;								%频率误差 
ehr=(hrx-hr)./hr*100;							%幅度误差 
edeg=(degx-deg);								%相位误差 
% 结果输出： 
subplot(2,2,1);
%画出采样序列 
plot(t,x); 
hold on; 
plot(t,x.*w,'r');
%加窗波形 
hold off; 
xlabel('x(k)'); 
title('原信号和加窗信号 '); 
subplot(2,2,2);
%画出FFT分析结果 
stem(xaxis,amp,'.r'); 
xlabel('频率'); 
title('幅频结果'); 
subplot(2,2,4); 
stem(xaxis,pha,'.r'); 
xlabel('角频率'); 
title('相频结果'); 
subplot(2,2,3); 
stem(ehr); 
title('幅度误差(%)'); 
%文本输出 
fid=fopen('result.txt','w'); 
fprintf(fid,'原始数据：f1=%6.1fHz, N=%.f,  fs=%.f \r\n\r\n',f1,N,fs); 
fprintf(fid,'谐波次数      1      2      3      4      5      6     7\r\n'); 
fprintf(fid,'设定频率 %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f\r\n',f); 
fprintf(fid,'估计频率 %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f\r\n',fx); 
fprintf(fid,'误差(%%)  %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f\r\n\r\n',efx); 
fprintf(fid,'设定幅值 %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f\r\n',hr); 
fprintf(fid,'估计幅值 %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f\r\n',hrx); 
fprintf(fid,'误差(%%)  %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f %6.3f\r\n\r\n',ehr); 
fprintf(fid,'设定相位 %6.2f %6.2f %6.2f %6.2f %6.2f %6.2f %6.2f\r\n',deg); 
fprintf(fid,'估计相位 %6.2f %6.2f %6.2f %6.2f %6.2f %6.2f %6.2f\r\n',degx); 
fprintf(fid,'误差(度)  %6.2f %6.2f %6.2f %6.2f %6.2f %6.2f %6.2f\r\n\r\n',edeg); 
%其他数据 
fprintf(fid,'谱峰位置理论值：\r\n %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f\r\n',[1:M]*f1/fmin); 
fprintf(fid,'谱峰位置估计值：\r\n %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f\r\n',km-1+delta); 
fprintf(fid,'误差（%%）\r\n %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f\r\n',((km-1+delta)-[1:M]*f1/fmin)./([1:M]*f1/fmin)*100); 
fprintf(fid,'delta     ：\r\n %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f %6.4f\r\n',delta); 
fclose(fid);

%运行过程中的调用子程序：
function index1=searchpeaks(x,index) 
%在数组中寻找最大值对应的下标 
%x为数组，index 为给定的下标(index不能取最前或最后2个下标)，在前后2个数中（共5个数）查找最大值和紧邻的次最大值 
% indexmax 返回两个谱峰位置中的前一个谱峰对应的下标 
index1=index-2; 
for k=-1:2 
    if(x(index+k)>x(index1)) 
        index1=index+k; 
    end 
end 
if x(index1-1)>x(index1+1) 
    index1=index1-1; 
end
```
```matlab
#result.txt输出结果
原始数据：f1=  50.1Hz, N=2048,  fs=10000 

谐波次数      1      2      3      4      5      6     7
设定频率 50.100 100.200 150.300 200.400 250.500 300.600 350.700
估计频率 50.100 78.819 150.302 181.252 250.499 279.138 350.701
误差(%)  -0.000 -21.338  0.001 -9.555 -0.000 -7.140  0.000

设定幅值 35.355  0.000  2.482  0.000  1.252  0.000  1.125
估计幅值 35.356  0.046  2.482  0.002  1.252  0.002  1.125
误差(%)   0.001    Inf  0.009    Inf  0.004    Inf  0.003

设定相位  10.00   0.00  40.00   0.00  70.00   0.00 110.00
估计相位  10.03  31.67  39.97 338.35  70.06 329.86 110.05
误差(度)    0.03  31.67  -0.03 338.35   0.06 329.86   0.05

谱峰位置理论值：
 10.2605 20.5210 30.7814 41.0419 51.3024 61.5629 71.8234
谱峰位置估计值：
 10.2605 16.1421 30.7818 37.1203 51.3022 57.1675 71.8235
误差（%）
 -0.0002 -21.3385 0.0012 -9.5551 -0.0004 -7.1396 0.0002
delta     ：
 0.2605 0.1421 0.7818 0.1203 0.3022 0.1675 0.8235
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wL0WYF6F-1573836815517)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanning_han.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010319821.jpg)
#### 汉明窗FIR滤波器
汉宁窗（hanming window）又称改进升余弦窗，窗函数为：
$$
w_{Hn}(n) = [0.54-0.46*cos(\frac{2\pi*n}{N-1})]*R_N(n)
$$
幅值函数为：
$$
W_{Hn}(w) = 0.54W_R(w) + 0.23[W_R(w-\frac{2\pi}{N-1})+0.23W_R(w+\frac{2\pi}{N-1})]
$$
汉明窗主瓣宽度与汉宁窗相同$8π/N$,99.96%的能量集中在主瓣，第一瓣比主瓣低41dB。

在Matlab中，实现汉宁窗的函数为hanming,其调用格式如下：

```matlab
w=hanming(N)
```
案例分析1：设计一个汉明窗低通滤波器：

```matlab
%语音信号设计一个汉明窗低通滤波器：
[x,FS,bits]=wavread('C:\Windows\Media\Windows Ringout');
x=x(:,1);
figure(1);
subplot(211);plot(x);
title('语音信号时域波形图')
xlabel('n');ylabel('h(n)')
grid on
y=fft(x,1000);
f=(FS/1000)*[1:1000];  
subplot(212);
plot(f(1:300),abs(y(1:300)));
title('语音信号频谱图');
xlabel('频率');ylabel('幅度')
grid on
%产生噪声信号并加到语音信号
t=0:length(x)-1;
zs0=0.05*cos(2*pi*10000*t/1024);
zs=[zeros(0,20000),zs0];
figure(2);
subplot(211)
plot(zs)
title('噪声信号波形');
xlabel('n');ylabel('h(n)')
grid on
zs1=fft(zs,1200);
subplot(212)
plot(f(1:600),abs(zs1(1:600)));
title('噪声信号频谱');
xlabel('频率');ylabel('幅度')
grid on
x1=x+zs';
%sound(x1,FS,bits);
y1=fft(x1,1200);
figure(3);
subplot(211);plot(x1);
title('加入噪声后的信号波形');
xlabel('n');ylabel('h(n)')
grid on
subplot(212);
plot(f(1:600),abs(y1(1:600)));
title('加入噪声后的信号频谱');
xlabel('频率');ylabel('幅度')
grid on
%滤波
fp=7500;
fc=8500; 
wp=2*pi*fp/FS;
ws=2*pi*fc/FS;
Bt=ws-wp; 
N0=ceil(6.2*pi/Bt);     
N=N0+mod(N0+1,2);
wc=(wp+ws)/2/pi;         
hn=fir1(N-1,wc,hamming(N)); 
X=conv(hn,x);           
X1=fft(X,1200);
figure(4);
subplot(211);
plot(X);
title('滤波后的信号波形');
xlabel('n');ylabel('h(n)')
grid on
subplot(212);
plot(f(1:600),abs(X1(1:600))); 
title('滤波后的信号频谱')
xlabel('频率');ylabel('幅度')
grid on
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-IRdanKny-1573836815518)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanming_lowp_1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010603315.jpg)

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-zpDvFiHo-1573836815519)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanming_lowp_noise.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010633875.jpg)

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-bBaOdODs-1573836815521)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanming_lowp_addnoise.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010659609.jpg)

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-iBooX8kL-1573836815523)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanming_lowp_hanfilter.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010721484.jpg)

案例分析2：已知连续信号为`$x_a(t)=cos(100{\pi}t) +sin(100{\pi}t)+cos(50{\pi}t)$`，用DFT分析其中`$x_a(t)$`的频谱结构，选择不同的截取长度`$T_p$`。观察存在的截断效应，试用加窗的方法减少谱间干扰。
```matlab
clear;close all
fs=400;T=1/fs;						%采样频率和采样间隔
Tp=0.04;N=Tp*fs;					%采样点数N
N1=[N,4*N,8*N];					%设定三种截取长度 
for m=1:3
    n=1:N1(m);
    xn=cos(100*pi*n*T)+ sin(200*pi*n*T)+ cos(50*pi*n*T);
    Xk=fft(xn,4096);
fk=[0:4095]/4096/T;
subplot(3,2,2*m-1);plot(fk,abs(Xk)/max(abs(Xk)));
if m==1 title('矩形窗截取');
end
end
%hamming窗截断
for m=1:3
    n=1:N1(m);
    wn=hamming(N1(m));
    xn=cos(200*pi*n*T)+ sin(100*pi*n*T)+ cos(50*pi*n*T).*wn';
    Xk=fft(xn,4096);
fk=[0:4095]/4096/T;
subplot(3,2,2*m);plot(fk,abs(Xk)/max(abs(Xk)));
if m==1 title('hamming窗截取');
end
end
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-39eMxIRF-1573836815524)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\hanming_dft.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116010944501.jpg)

比较矩形窗与汉明窗的普分析结果可见，矩形窗比用汉明窗分辨率高（泄露小），但是谱间干扰大。因此汉明窗是以牺牲分辨率来换取谱间干扰降低。
#### 布莱克曼FIR滤波器
布莱克曼（Blackman window）的窗函数为：
$$
w_{Bl}(n) = [0.42-0.5*cos(\frac{2\pi*n}{N-1})+0.08*cos(\frac{4\pi*n}{N-1})]*R_N(n)
$$
幅值函数为：
$$
W_{Hn}(w) = 0.42W_R(w) + 0.25[W_R(w-\frac{2\pi}{N-1})+W_R(w+\frac{2\pi}{N-1})]\\
+0.04[W_R(w-\frac{4\pi}{N-1}+W_R(w+\frac{4\pi}{N-1})]
$$
布莱克曼窗幅度函数由5部分相加而成，5部分相加的结果使得旁瓣得到进一步抵消，阻带衰减加大而过渡带加大到$12{\pi}/N$。

在Matlab中，实现布莱克曼窗的函数为blackman ,其调用格式如下：
```matlab
w=blackman(N);
```
案例：用窗函数法设计数字带通滤波器。下阻带边缘：$W_{s1}=0.3{\pi}，A_s=65dBW$，下通带边缘:$W_{p1}=0.4{\pi}，R_p=1dB$,上通带边缘：$W_{p2}=0.6{\pi}，R_p=1dB$，上阻带边缘:$W_{s2}=0.7{\pi}，R_p=65dB$。根据窗函数最小阻带衰减的特性，以及参照窗函数的基本参数表，选择布莱克曼窗可以达到75dB的最小阻带衰减，其过渡带为$11\pi/N$。
```matlab
clear all;
wp1=0.4*pi;
wp2=0.6*pi;
ws1=0.3*pi;
ws2=0.7*pi;
As=65;
tr_width=min((wp1-ws1),(ws2-wp2)); 					%过渡带宽度 
M=ceil(11*pi/tr_width)+1							%滤波器长度
n=[0:1:M-1];
wc1=(ws1+wp1)/2;									%理想带通滤波器的下截止频率
wc2=(ws2+wp2)/2;									%理想带通滤波器的上截止频率
hd=ideal_lp(wc2,M)-ideal_lp(wc1,M);
w_bla=(blackman(M))';								%布莱克曼窗
h=hd.*w_bla;
%截取得到实际的单位脉冲响应
[db,mag,pha,grd,w]=freqz_m(h,[1]);
%计算实际滤波器的幅度响应
delta_w=2*pi/1000;
Rp=-min(db(wp1/delta_w+1:1:wp2/delta_w))
%实际通带纹波
As=-round(max(db(ws2/delta_w+1:1:501)))
As=75
subplot(2,2,1);
stem(n,hd);
title('理想单位脉冲响应hd(n)')
axis([0 M-1 -0.4 0.5]);
xlabel('n');
ylabel('hd(n)')
grid on;
subplot(2,2,2);
stem(n,w_bla);
title('布莱克曼窗w(n)')
axis([0 M-1 0 1.1]);
xlabel('n');
ylabel('w(n)')
grid on;
subplot(2,2,3);
stem(n,h);
title('实际单位脉冲响应hd(n)')
axis([0 M-1 -0.4 0.5]);
xlabel('n');
ylabel('h(n)')
grid on;
subplot(2,2,4);
plot(w/pi,db);
axis([0 1 -150 10]);
title('幅度响应(dB)');
grid on;
xlabel('频率单位:pi');
ylabel('分贝数')

%调用小程序设计1：
function [db,mag,pha,grd,w] = freqz_m(b,a);
% Modified version of freqz subroutine
% ------------------------------------
% [db,mag,pha,grd,w] = freqz_m(b,a);
%  db = Relative magnitude in dB computed over 0 to pi radians
% mag = absolute magnitude computed over 0 to pi radians 
% pha = Phase response in radians over 0 to pi radians
% grd = Group delay over 0 to pi radians
%   w = 501 frequency samples between 0 to pi radians
%   b = numerator polynomial of H(z)   (for FIR: b=h)
%   a = denominator polynomial of H(z) (for FIR: a=[1])
%
[H,w] = freqz(b,a,1000,'whole');
    H = (H(1:1:501))'; w = (w(1:1:501))';
  mag = abs(H);
   db = 20*log10((mag+eps)/max(mag));
  pha = angle(H);
%  pha = unwrap(angle(H));
  grd = grpdelay(b,a,w);
%  grd = diff(pha);
%  grd = [grd(1) grd];
%  grd = [0 grd(1:1:500); grd; grd(2:1:501) 0];
%  grd = median(grd)*500/pi;

%调用小程序设计2：
function hd=ideal_lp(wc,M);
%计算理想低通滤波器的脉冲响应
%[hd]=ideal_lp(wc,M)
%hd=理想脉冲响应0到M-1
%wc=截止频率
% M=理想滤波器的长度
alpha=(M-1)/2;
n=[0:1:(M-1)];
m=n-alpha+eps;
%加上一个很小的值eps避免除以0的错误情况出现
hd=sin(wc*m)./(pi*m);
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-52LsWSri-1573836815526)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\blackmen_bandp.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116011035555.jpg)
#### 凯塞窗FIR滤波器
凯塞-贝塞窗（Kaiser-Basel window)的窗函数为：
$$
w_{k}(n) = \frac{I_0( β )}{I_0( \alpha )}*R_N(n)
$$
式中，$\beta= {\alpha}{\sqrt{(1-(\frac{2n}{N-1})-1)^2}}$
 。

 $I_0( x )$是零阶第一类修正贝塞函数，可用下面级数计算：
$$
 I_0( x ) = 1+\sum_{k=1}^{+ ∞}（\frac{1}{k!}({\frac{x}{2}})^{k}）^{2}
$$
$I_0( x )$取15-25项就可以满足精度要求。通常$\alpha$用以控制窗的形状，$\alpha$加大，主瓣加宽，旁瓣减小，典型数据$4<\alpha<9$。当$\alpha=5.44$时，窗函数接近汉明窗；当$\alpha=7.865$时，窗函数接近于布莱克曼窗。其幅值函数为：
$$
W_{k}(w) =w_k(0) + 2\sum_{n=1}^{\frac{(N-1)}{2}}(w_k(n)cos(wn))
$$

在Matlab中，实现汉宁窗的函数为kaiser,其调用格式如下：
```matlab
w=kaiser(N);
```
在Matlab中设计标准响应FIR滤波器可使用fir1函数。fir1函数以经典方法实现加窗性相位FIR滤波器的设计，它可以设计出标准的低通、高通、带通、带阻滤波器。fir1函数用法为：
```matlab
b = fir1(n,Wn,‘ftype’,wimdow)
```
各个参数的含义如下：

- b -滤波器系数，n-滤波器阶数。
- Wn -截止频率，$0<=W_n<=1,W_n=1$对应于采样频率的一半。当设计带通和带阻滤波器时，$W_n =[W_1,W_2],W_1<w<W_2$
- ftype -当指定ftype时，可设计高通和带阻滤波器。ftype=hight时，设计高通FIR滤波器；ftype=stop时设计带阻FIR滤波器。低通和带通FIR滤波器无需输入ftype参数。
- window–窗函数。窗函数的长度应等于FIR滤波器系数的个数，即阶数n+1。

案例分析：利用凯塞窗函数设计一个带通滤波器，上截止频率2500Hz,下截止频率1000Hz，过渡带宽200Hz,通带纹波允许差0.1，带阻纹波不大于允差0.02dB，通带幅值为1。
```matlab
Fs=8000;N=216;
fcuts=[1000 1200 2300 2500];
mags=[0 1 0];
devs=[0.02 0.1 0.02];
[n,Wn,beta,ftype]=kaiserord(fcuts,mags,devs,Fs);
n=n+rem(n,2);
hh=fir1(n,Wn,ftype,kaiser(n+1,beta),'noscale');
[H,f]=freqz(hh,1,N,Fs);
plot(f,abs(H));
xlabel('频率 (Hz)');
ylabel('幅值|H(f)|');
grid on;
```
![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-zSlKyrYh-1573836815527)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\kaser_bandp.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/2019111601110985.jpg)
#### 窗函数设计法
根据前面几节的分析：设计一个FIR低通滤波器通常按照下面的步骤执行：

- 根据滤波器设计要求，确定滤波器的过渡带宽和阻带衰减要求，选择合适窗函数的类型并进行估计窗函数的宽度N。
- 根据所求的理想滤波器求出单位脉冲响应`$h_d(n)$`
- 根据求得的h(n)求出其频率响应。
- 根据频率响应验证是否满足技术指标。
- 若不满足指标要求，则应调整窗函数类型或者长度，然后重复(1),(2),(3)(4)步，直到满足要求为止。

注意：matlab中数据通常是以列向量形式存储的，所以两个向量相乘必须进行转置。计算滤波器的单位脉冲响应h(n),根据窗函数设计理论$h(n)=h_d(n)*w(n)$,在matlab中用语句hn=hd*wd实现h(n).

窗函数设计法程序设计如下：

```matlab
function [h]=usefir1(mode,n,fp,fs,window,r,sample)
% mode:模式(1--高通; 2--低通; 3--带通; 4--带阻)
% n:阶数, 加窗的点数为阶数加1
% fp:高通和低通时指示截止频率, 带通和带阻时指示下限频率
% fs:带通和带阻时指示上限频率
% window:加窗(1--矩形窗; 2--三角窗; 3--巴特窗; 4--汉明窗; 
%5--汉宁窗; 6--布莱克曼窗; 7--凯泽窗; 8--契比雪夫窗)
% r代表加chebyshev窗的r值和加kaiser窗时的beta值
% sample:采样率
% h:返回设计好的FIR滤波器系数
if window==1 w=boxcar(n+1);end
if window==2 w=triang(n+1);end
if window==3 w=bartlett(n+1);end
if window==4 w=hamming(n+1);end
if window==5 w=hanning(n+1);end
if window==6 w=blackman(n+1);end
if window==7 w=kaiser(n+1,r);end
if window==8 w=chebwin(n+1,r);end
wp=2*fp/sample;
ws=2*fs/sample;
if mode==1 h=fir1(n,wp,'high',w);
end
if mode==2 h=fir1(n,wp,'low',w);
end
if mode==3 h=fir1(n,[wp,ws],w);
end
if mode==4 h=fir1(n,[wp,ws],'stop',w);
end
m=0:n;
subplot(131);
plot(m,h);grid on;	
title('冲激响应');
axis([0 n 1.1*min(h) 1.1*max(h)]);
ylabel('h(n)');xlabel('n');
freq_response=freqz(h,1);
magnitude=20*log10(abs(freq_response));
m=0:511; f=m*sample/(2*511);
subplot(132);
plot(f,magnitude);grid on;
title('幅频特性');
axis([0 sample/2 1.1*min(magnitude) 1.1*max(magnitude)]);
ylabel('f幅值');xlabel('频率');
phase=angle(freq_response);
subplot(133);plot(f,phase);grid on;
title('相频特性');
axis([0 sample/2 1.1*min(phase) 1.1*max(phase)]);
ylabel('相位');xlabel('频率');
```
案例分析：假设需要设计一个40阶的带通FIR滤波器，采用汉明窗，采样频率为10kHz,两个截止频率分别为2kHz和3kHz,则需要在Matlab的命令行窗口输入：

```matlab
h=usefir1(3,60,2000,3000,4,2,10000);
```

![[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-8Mmw8ohg-1573836815529)(G:\研究生\项目小组任务\笔记\第四周和第五周笔记\usefir1.jpg)]](056.%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8(%E4%B8%83)--Matlab%E6%95%B0%E5%AD%97%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1.assets/20191116011149995.jpg)

## 现代滤波器设计

### LMS滤波器设计
#### TBD
### 维纳滤波器设计
#### TBD
### 卡尔曼滤波器设计
#### TBD